' Gambas class file

'Gambas class file
Public zzz As String
Public xxx As String
Public z As String[]
Public cc As String
Const sh As String = "reports.txt"
Public g As Integer


Public Sub Form_Open()
  Dim a As String
  Dim b As File
  Dim c As String
  Dim d As String
  Dim e As String[]
  Dim command As String
  TextArea1.Visible = False
  ListBox1.Visible = True
  command = "/home/pi/macros/macro/menu.list"
  command = Args[1]
  cc = command
 g = 0 
  z = New String[]
  b = Open command For Input
  Do
    Line Input #b, a
      ListBox1.Add(a)
      z.Add(a)
  Loop Until Eof(b)
  Close #b
End

Public Sub ListBox1_Click()
  Dim p As Process
  Dim t As File
  Dim b As File
  Dim commands As String
  Dim command As String
  Dim zz As String
  Dim a As String
 
  zz = z[ListBox1.Index]
 
  If InStr(zz, "|") > 0 Then zz = Replace(z[ListBox1.Index], "|", gb.Lf)
  
  zz = zz & gb.lf & "exit" & gb.Lf
  
  
  TextArea1.text = ""
  TextArea1.Visible = True
  ListBox1.Visible = False
  
  zzz = ""
  p = Shell "sh " For Read Write As "p" 
  
  Print #p, zz
g = 1  
'Finally
'Catch
End

Public Sub Menu2_Click()
  TextArea1.Text = ""
  TextArea1.Visible = True
  ListBox1.Visible = False
  g = 0  
End

Public Sub Menu4_Click()
  Dim b As File
  Dim commands As String
  Dim command As String
  Dim zz As String

  TextArea1.Visible = False
  ListBox1.Visible = True
  
  command = cc
  If g = 1 Then Goto escape5
  zz = Replace(TextArea1.Text, gb.Lf, "|")
  b = Open command For Append
    Print #b, zz
  Close #b
    ListBox1.Add(zz)
    z.Add(zz)
    escape5:
    TextArea1.text = ""
End

Public Sub p_Read()
  Dim s As String
   s = Read #Last, -256
  TextArea1.Text = TextArea1.Text & s & gb.Lf 
End
